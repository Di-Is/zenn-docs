---
title: "ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã‚’åˆ©ç”¨ã—ãªã„Gitlabâ†’Azure App Serviceã¸ã®ç¶™ç¶šçš„ãƒ‡ãƒ—ãƒ­ã‚¤"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Azure", "AzureAppService"]
published: true
---

## ã¯ã˜ã‚ã«

Azure App Serviceã¸Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ç¶™ç¶šãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆã€æ§‹æˆç®¡ç†ã‚„CI/CDç’°å¢ƒæ¯ã«ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãŒå¤‰ã‚ã£ã¦ãã¾ã™ã€‚
â†“ã¯ç§ãŒæ€ã†ã€ãƒªãƒã‚¸ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹æ¯ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã™ã€‚

1. (Github) å°‚ç”¨ã®Github Actions([webapps-deploy](https://github.com/Azure/webapps-deploy))ã§ãƒ‡ãƒ—ãƒ­ã‚¤
2. (Azure Repos) Azure Pipelinesã‚’åˆ©ç”¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤
3. (ãã®ä»–) ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã‚’ç™ºè¡Œã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ä¸­ã§azã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤

è‡ªç¤¾ã®ç’°å¢ƒã§ã¯ã‚¤ãƒ³ãƒˆãƒ©ã®Gitlabã§ã‚³ãƒ¼ãƒ‰ã‚’ç®¡ç†ã—ã¦ã„ã¾ã™ãŒã€è«¸äº‹æƒ…ã§ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã®ç™ºè¡ŒãŒã§ããš`3.`ã®æ–¹æ³•ãŒå–ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚

ä¸€å¿œã€Azure App Serviceã«ã¯Azure Container Registryã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ›´æ–°ã•ã‚ŒãŸéš›ã€App Serviceã§ä½¿ç”¨ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚‚æ›´æ–°ã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚‹ã‚‚ã®ã®ã€è‡´å‘½çš„ãªæ¬ é™¥â€»1ãŒã‚ã‚Šæ­£ç›´ä½¿ãˆã‚‹ãƒ¬ãƒ™ãƒ«ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
(è©³ã—ãã¯æœ«å°¾ã®å‚è€ƒæ–‡çŒ®ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚)

ä¸Šè¨˜ã®èƒŒæ™¯ãŒã‚ã‚Šã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã‚’åˆ©ç”¨ã›ãšç¤¾å†…ã‚¤ãƒ³ãƒˆãƒ©->Azure App Serviceã¸ã®ç¶™ç¶šçš„ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã‚ã®ç’°å¢ƒã‚’æ§‹ç¯‰ã§ããŸã®ã§æƒ…å ±ã‚’å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

â€»1: [Web App for Containers ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã§ã¤ã¾ãšã„ãŸè©± p20~](https://www.slideshare.net/slideshow/web-app-for-containers/202301272)ã‚’å‚ç…§ã€‚

## å‰æ

ã ã„ã¶ãƒ‹ãƒƒãƒã§ã™ãŒã€ä»¥ä¸‹ã®æ¡ä»¶ä¸‹ã§CI/CDç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

- App Serviceã¯Linuxç’°å¢ƒã€ã‚³ãƒ³ãƒ†ãƒŠæ–¹å¼ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æƒ³å®š
- Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒª(e.g. Azure Container Registry)ã§ç®¡ç†
- ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã¯æœªåˆ©ç”¨
- æ§‹æˆç®¡ç†ã¯ã‚¤ãƒ³ãƒˆãƒ©ã®Gitlabã€CI/CDã¯Gitlab CIã®åˆ©ç”¨ã‚’æƒ³å®š
- ç«‹ã¡ä¸Šã’ãŸã„ã‚³ãƒ³ãƒ†ãƒŠã¯ä¸€ç¨®(è¤‡æ•°ç¨®ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’åŒæ™‚ã«èµ·å‹•ã—ãªã„)

## è¦ç‚¹ã¨çµè«–

Kudu REST API & ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹èªè¨¼ã§App Serviceã§åˆ©ç”¨ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ›´æ–°ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚

ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®èªè¨¼ã¯ä¸€èˆ¬çš„ãªãƒ™ãƒ¼ã‚·ãƒƒã‚¯èªè¨¼ã§ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ãŒä¸è¦ã§ã™ã€‚
ä»¥ä¸‹ã«ç›¸å½“ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’Gitlab CIã«çµ„ã¿è¾¼ã‚ã°ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã‚’åˆ©ç”¨ã—ãªã„App Serviceã®ç¶™ç¶šçš„ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Ÿç¾ã§ãã¾ã™ã€‚

```bash
$ curl -X POST "${SCM_URL}/api/app/update" \
    -u "${PUBLISH_PROFILE_USER}:${PUBLISH_PROFILE_PASSWORD}" \
    -H "Content-Type: application/json" \
    -H "LinuxFxVersion:DOCKER|${ImageName}:${TagName}"
```

- SCM_URL: App Serviceã®SCMã®URLã€Azure Portalã§App Serviceã®ãƒšãƒ¼ã‚¸ã«é£›ã³ã€`é–‹ç™ºãƒ„ãƒ¼ãƒ« -> é«˜åº¦ãªãƒ„ãƒ¼ãƒ«`ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒšãƒ¼ã‚¸ã®URL
- PUBLISH_PROFILE_USER: ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€Azure Portalã®`ãƒ‡ãƒ—ãƒ­ã‚¤ -> ãƒ‡ãƒ—ãƒ­ã‚¤ ã‚»ãƒ³ã‚¿ãƒ¼ -> ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ç®¡ç†`ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- PUBLISH_PROFILE_PASSWORD: ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
- ImageName: ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã„ã‚¤ãƒ¡ãƒ¼ã‚¸
- TagName: ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¿ã‚°

__å‰ææ¡ä»¶ã¨åˆ¶ç´„__

å‰è¿°ã—ãŸã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ãŸã‚ã«ã¯ã€äº‹å‰ã«ã—ã¦ãŠãã¹ãè¨­å®šã‚„ã€ä¸€éƒ¨è¨­å®šå€¤ã«åˆ¶ç´„ãŒã‚ã‚Šã¾ã™ã€‚

- Kuduã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€Azure Portalã®App Serviceã®ãƒšãƒ¼ã‚¸ã§`è¨­å®š->æ§‹æˆ`ã‹ã‚‰`SCM åŸºæœ¬èªè¨¼ã®ç™ºè¡Œè³‡æ ¼æƒ…å ±`ã®æœ‰åŠ¹åŒ–ãŒå¿…è¦
- ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã‚ã€`ãƒ‡ãƒ—ãƒ­ã‚¤->ãƒ‡ãƒ—ãƒ­ã‚¤ã‚»ãƒ³ã‚¿ãƒ¼`ã§ä»¥ä¸‹ã®è¨­å®šãŒå¿…è¦
  - `ã‚½ãƒ¼ã‚¹`ã¯`Container Registry`ã¨ã—ã¦è¨­å®šæ¸ˆã¿
  - `ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã®ç¨®é¡`ã¯`å˜ä¸€ã‚³ãƒ³ãƒ†ãƒŠãƒ¼`ã¨ã—ã¦è¨­å®šæ¸ˆã¿
  - `ãƒ¬ã‚¸ã‚¹ãƒˆãƒª ã‚½ãƒ¼ã‚¹`ã¯é©å½“ãªã‚‚ã®ãŒé¸æŠã•ã‚Œã€å¿…é ˆã®è¨­å®šé …ç›®ãŒè¨­å®šæ¸ˆã¿
    - (Kudu REST APIã§ã¯Dockerhubâ†’Azure Container Registryã®ã‚ˆã†ãªã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®å¤‰æ›´ã¯ä¸å¯)

## èª¿æŸ»

ä»¥é™ã¯å‰è¿°ã—ãŸå¯¾ç­–ã«ãŸã©ã‚Šç€ãã¾ã§ã®å–ã‚Šçµ„ã¿ã‚’é †ã‚’è¿½ã£ã¦èª¬æ˜ã—ã¾ã™ã€‚
ã¨ã‚Šã‚ãˆãšã€ã‚ã¼ã—ã„æƒ…å ±ãŒãªã„ã‹Microsoftã®ç”¨æ„ã—ã¦ã„ã‚‹å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã¾ãšå‚ç…§ã—ã¾ã—ãŸã€‚

- [GitHub Actions ã‚’ä½¿ç”¨ã—ãŸ App Service ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤](https://learn.microsoft.com/ja-jp/azure/app-service/deploy-github-actions?source=recommendations&tabs=openid%2Caspnetcore)
  - [webapps-deploy](https://github.com/Azure/webapps-deploy/tree/releases/v3): App Serviceã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã‚ã®Github Actions
- [Azure Pipelines ã‚’ä½¿ç”¨ã—ã¦ Azure App Service ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹](https://learn.microsoft.com/ja-jp/azure/app-service/deploy-azure-pipelines?tabs=yaml)

æ®‹å¿µãªãŒã‚‰ã€Gitlab(Azure Reposã¯é™¤å¤–)ã¨App Serviceã®ç¶™ç¶šçš„ãƒ‡ãƒ—ãƒ­ã‚¤ã«é–¢ä¿‚ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€æ¬¡ã«å…ˆé§†è€…ãŒã„ãªã„ã‹ã‚°ã‚°ã‚Šã¾ã—ãŸã€‚
ã“ã¡ã‚‰ã€æœ‰ç›Šãªæƒ…å ±ãŒå¾—ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã€ä¸€æ—¦æœ€åˆã«è¦‹ã¤ã‘ã¦ã„ãŸGithub Actions webapps-deployã®ã‚³ãƒ¼ãƒ‰ã‚’è¦—ã„ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

- [GitLabã‹ã‚‰Web Apps for Containerã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•](https://level69.net/archives/29060)
- [Azure DevOpsãƒªãƒã‚¸ãƒˆãƒªã‚’GitLabã¨çµ±åˆã™ã‚‹æ–¹æ³•](https://about.gitlab.com/ja-jp/blog/2020/07/09/integrating-azure-devops-scm-and-gitlab/)

ä»¥ä¸‹ã¯webapps-deployãƒªãƒã‚¸ãƒˆãƒªã®README.mdã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹Github Actionsã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æŠœç²‹ã§ã™ã€‚

```yml
on: [push]

name: Linux_Container_Node_Workflow

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    # checkout the repo
    - name: 'Checkout Github Action'
      uses: actions/checkout@master

    - uses: azure/docker-login@v1
      with:
        login-server: contoso.azurecr.io
        username: ${{ secrets.REGISTRY_USERNAME }}
        password: ${{ secrets.REGISTRY_PASSWORD }}

    - run: |
        docker build . -t contoso.azurecr.io/nodejssampleapp:${{ github.sha }}
        docker push contoso.azurecr.io/nodejssampleapp:${{ github.sha }} 

    - uses: azure/webapps-deploy@v2
      with:
        app-name: 'node-rnc'
        publish-profile: ${{ secrets.azureWebAppPublishProfile }}
        images: 'contoso.azurecr.io/nodejssampleapp:${{ github.sha }}'
```

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ä»¥ä¸‹ã®æµã‚Œã§é€²ã‚€ã‚ˆã†ã«å‡¦ç†ãŒè¨˜è¿°ã•ã‚Œã¦ã„ã¾ã™ã€‚

1. Azure Container Registry(ACR)ã¸ãƒ­ã‚°ã‚¤ãƒ³
2. ACRã¸ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒƒã‚·ãƒ¥
3. ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¿ã‚°ã‚’æŒ‡å®šã™ã‚‹å½¢ã§App Serviceã¸ãƒ‡ãƒ—ãƒ­ã‚¤

App Serviceã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã‚ãŸã‚Šã€`azure/login`ã‚„`az login`ã‚’äº‹å‰ã«å®Ÿè¡Œã—ã¦ã„ãªã„ãŸã‚ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã‚„Entra IDã®è³‡æ ¼æƒ…å ±ã¯ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“ã€‚
ä»£ã‚ã‚Šã«ã€ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«(publish-profile)ã¨å‘¼ã°ã‚Œã‚‹è³‡æ ¼æƒ…å ±ã‚’Secretã§æ¸¡ã—ã¦ã€ACRã®Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã—ã¦ã„ã¾ã™ã€‚
ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ‡ãƒ—ãƒ­ã‚¤æ“ä½œã®ãŸã‚ã®è³‡æ ¼æƒ…å ±ã€ãŠã‚ˆã³ãã‚Œã‚’æ ¼ç´ã—ãŸxmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡ã—ã¾ã™ã€‚

- [Azure Functions ã¸ã® Zip Deploy ã‚’ Publish Profile ã‚’ä½¿ã£ã¦è¡Œã†æ–¹æ³•](https://blog.shibayan.jp/entry/20210105/1609830075)
- [Azure ã‹ã‚‰ç™ºè¡Œè¨­å®šã‚’å–å¾—ã—ã€Visual Studio ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹](https://learn.microsoft.com/ja-jp/visualstudio/deployment/tutorial-import-publish-settings-azure?view=vs-2022)

ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ãƒ™ãƒ¼ã‚·ãƒƒã‚¯èªè¨¼ã®ãŸã‚ã®userName(ãƒ¦ãƒ¼ã‚¶ãƒ¼å)ã¨userPWD(ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰)ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

```xml
<publishData>
    <publishProfile profileName="XXXXXXX - Web Deploy" publishMethod="MSDeploy" publishUrl="XXXXXXX.scm.azurewebsites.net:443" msdeploySite="XXXXXXX" userName="$XXXXXXX" userPWD="hogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge" destinationAppUrl="http://XXXXXXX.azurewebsites.net" SQLServerDBConnectionString="" mySQLDBConnectionString="" hostingProviderForumLink="" controlPanelLink="http://windows.azure.com" webSystem="WebSites">
        <databases />
    </publishProfile>
    <publishProfile profileName="XXXXXXX - FTP" publishMethod="FTP" publishUrl="ftp://waws-prod-ty1-051.ftp.azurewebsites.windows.net/site/wwwroot" ftpPassiveMode="True" userName="XXXXXXX\$XXXXXXX" userPWD="hogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge" destinationAppUrl="http://iwasa20211103aspcore.azurewebsites.net" SQLServerDBConnectionString="" mySQLDBConnectionString="" hostingProviderForumLink="" controlPanelLink="http://windows.azure.com" webSystem="WebSites">
        <databases />
    </publishProfile>
    <publishProfile profileName="XXXXXXX - Zip Deploy" publishMethod="ZipDeploy" publishUrl="XXXXXXX.scm.azurewebsites.net:443" userName="$XXXXXXX" userPWD="hogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge" destinationAppUrl="http://XXXXXXX.azurewebsites.net" SQLServerDBConnectionString="" mySQLDBConnectionString="" hostingProviderForumLink="" controlPanelLink="http://windows.azure.com" webSystem="WebSites">
        <databases />
    </publishProfile>
</publishData>
```

Azure App Serviceã§ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®Kuduã¨å‘¼ã°ã‚Œã‚‹ç®¡ç†ç”¨ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒWebã‚¢ãƒ—ãƒªã¨ã¯åˆ¥ã§èµ·å‹•ã—ã¦ãŠã‚Šã€ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯Kubuå´ã®æ“ä½œã«å¿…è¦ã«ãªã‚‹è³‡æ ¼æƒ…å ±ã§ã™ã€‚
Kuduã®REST APIã¯ä¸€å¿œGithubã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ãŒã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®æ›´æ–°ã«ä½¿ãˆãã†ãªAPIãŒã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€ChatGPTã«èª¿ã¹ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚

- [Kudu ã‚µãƒ¼ãƒ“ã‚¹ã®æ¦‚è¦](https://learn.microsoft.com/ja-jp/azure/app-service/resources-kudu#access-kudu-for-your-app)
- [REST API](https://github.com/projectkudu/kudu/wiki/rest-api)

ChatGPTã«webapps-deployã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ¸¡ã—ã¦èª¿ã¹ã¦ã‚‚ã‚‰ã£ãŸçµæœã€ä½¿ç”¨ã—ã¦ã„ã‚‹APIã¯`POST /api/app/update`ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚

![](/images/d3b2d38af9ab13/container_update_api.png)

- [ChatGPT å¯¾è©±å±¥æ­´](https://chatgpt.com/share/68108103-e858-800f-8cfd-14708c64a237)

ã“ã®APIã¯å…¬å¼ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«ã¯è¨˜è¼‰ã•ã‚Œã¦ãŠã‚‰ãšã€Githubã§æ¤œç´¢å¯èƒ½ãªã‚³ãƒ¼ãƒ‰ã®ä¸­ã§ä½¿ã£ã¦ã„ã‚‹ã®ã¯Azure/webapps-deployã¨Azure/fuction-actionã®2ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã ã‘ã§ã—ãŸã€‚
Microsoftå´ã¯ã“ã®APIã‚’å…¬é–‹ã—ã¦ã„ãªã„æ„å›³ã¯ä¸æ˜ã§ã™ãŒã€ä¸€æ—¦ã¯ä½¿ãˆã¦ã„ã‚‹ã®ã§ã‚ˆã—ã¨ã—ã¦ã„ã¾ã™ã€‚

REST APIã¯ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã—ã¦Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã€ãŠã‚ˆã³ã‚¿ã‚°ã‚’å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

```bash
$ curl -X POST "${SCM_URL}/api/app/update" \
    -u "${PUBLISH_PROFILE_USER}:${PUBLISH_PROFILE_PASSWORD}" \
    -H "Content-Type: application/json" \
    -H "LinuxFxVersion:DOCKER|${ImageName}:${TagName}"
```

Gitlab CIã«ç™ºè¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ã—ã¦ç™»éŒ²ã—ã¦ãŠã‘ã°ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã€ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã«åŠ ãˆã€App Serviceã¸ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã®é©å¿œã¾ã§CI/CDã§å®Ÿè¡Œã§ãã‚‹ã®ã§ã€ç¶™ç¶šçš„ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Ÿç¾ã§ãã¾ã™ã€‚
